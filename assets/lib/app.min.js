var app = angular.module("SoundcloudApp", ["ngRoute"])

app.factory('soundcloudConnect', [
	function() {
		SC.initialize({
			client_id: 'bda4ada8694db06efcac9cf97b872b3e',
			redirect_uri: '/'
		});

        return SC;
	}
]);



// ========================================
// -- User
// ========================================
app.factory('User', ['soundcloudConnect',
    function(soundcloudConnect)
    {
        return {
            get : function(id) {
                return SC.get('/users/' + id);
            }
        }
    }
]);

// ========================================
// -- Tracks
// ========================================
app.factory('Tracks', ['soundcloudConnect',
    function(soundcloudConnect)
    {
        return {
            get : function(id) {
                return SC.get('/users/' + id + '/tracks');
            }
        }
    }
]);
app.config(['$routeProvider','$locationProvider',
	function($routeProvider, $locationProvider) {
    	$routeProvider
			.when("/", {
			    templateUrl : "views/welcome.html"
			})
			.when("/user", {
			    templateUrl : "views/user.html"
			})
			.when("/settings", {
			    templateUrl : "views/settings.html"
			})
			.when("/search", {
			    templateUrl : "views/search.html"
			})
		
		$locationProvider.html5Mode(true);
	}
]);

app.controller('GlobalCtrl', ['$scope', 
	function($scope) {
		$scope.name = 'Matthew';
	}
])

app.controller('UserCtrl', ['$scope', 'User', 'Tracks',
	function($scope, User, Tracks) {

		$scope.user = {
			id: 123,
			name: 'person who does not exist!',
			email: 'mmellows1@gmail.com',
			completion:70,
			color:'#323232',
			tracks:{},
			// genres: 
		}

		User.get($scope.user.id).then(function(res) {
			console.log(res);
		});

		Tracks.get($scope.user.id).then(function(res) {
			// $scope.user.tracks = tracks;
			console.log(res);
		})
	}
])
